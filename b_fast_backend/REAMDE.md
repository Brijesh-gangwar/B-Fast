# B-Fast Backend

The backend for B-Fast is built with Convex, a modern Backend-as-a-Service platform that provides real-time database, authentication, and serverless functions out of the box.

## Project Structure

```
b_fast_backend/
├── package.json              # Project dependencies and configuration
├── convex/
│   ├── schema.js             # Database schema definitions for all data models
│   ├── cart.js               # Cart management queries and mutations
│   ├── customers.js          # Customer-related operations
│   ├── deliveryAgents.js     # Delivery agent management and tracking
│   ├── orders.js             # Order creation, updates, and tracking
│   ├── products.js           # Product catalog and inventory management
│   ├── stores.js             # Store information and management
│   ├── storePartners.js      # Store partner operations
│   ├── userDetails.js        # User profile and details management
│   ├── wishlist.js           # Wishlist operations
│   ├── messages.js           # Messaging system between users
│   ├── mutations.js          # Shared mutations and data modifications
│   ├── myFunctions.js        # Utility functions and helpers
│   ├── http.js               # HTTP endpoints for external integrations
│   ├── tsconfig.json         # TypeScript configuration
│   └── _generated/
│       ├── api.d.ts          # Generated TypeScript definitions
│       ├── api.js            # Generated API client
│       ├── dataModel.d.ts    # Generated data model types
│       ├── server.d.ts       # Generated server types
│       └── server.js         # Generated server utilities
```

## Key Features

### Database Management
- **Schema Definition** (`schema.js`) - Defines all data models including users, orders, products, stores, delivery agents, etc.

### Core Modules

#### Carts & Orders
- `cart.js` - Shopping cart operations (add, remove, update items)
- `orders.js` - Complete order lifecycle management from creation to delivery

#### User & Customer Management
- `customers.js` - Customer profiles and account information
- `userDetails.js` - Extended user information and preferences
- `deliveryAgents.js` - Delivery agent management, location tracking, and availability

#### Products & Inventory
- `products.js` - Product listings, descriptions, pricing, and inventory management
- `wishlist.js` - Customer wishlist operations

#### Stores & Partnerships
- `stores.js` - Store profiles, information, and operational data
- `storePartners.js` - Partner store management and agreements

#### Communication
- `messages.js` - In-app messaging between customers and delivery agents

#### API & Integration
- `http.js` - HTTP endpoints for webhooks and external API integrations (e.g., payment callbacks)
- `mutations.js` - Core mutation functions shared across modules
- `myFunctions.js` - Helper functions and utilities

### Auto-Generated Files
- `_generated/` - TypeScript definitions and client code automatically generated by Convex

## Technology Stack

- **Backend Platform:** Convex
- **Language:** JavaScript/TypeScript
- **Database:** Convex Hosted Database
- **Authentication:** Integrated with Clerk
- **Real-time:** Convex provides built-in real-time subscriptions
- **API:** Convex HTTP actions for external integrations

## Getting Started

### Prerequisites
- Node.js (v16 or higher)
- Convex CLI (`npm install -g convex`)
- Convex project setup

### Installation

1. Install dependencies:
```bash
npm install
```

2. Set up Convex:
```bash
npx convex dev
```

3. Deploy to production:
```bash
npx convex deploy
```

## Database Schema

All database models are defined in `schema.js`. Key entities include:
- **Users** - Customer and agent profiles
- **Orders** - Order information and status
- **Products** - Store inventory
- **Stores** - Merchant information
- **Delivery Agents** - Agent profiles and real-time location
- **Carts** - Customer shopping carts
- **Messages** - Communication between users
- **Wishlist** - Customer saved items

## API Endpoints

HTTP endpoints are defined in `http.js` and handle:
- Payment gateway callbacks
- External service integrations
- Webhook handling

## Development Workflow

1. **Queries** - Read operations are defined in respective module files
2. **Mutations** - Write operations for creating/updating data
3. **Actions** - Async operations for complex business logic
4. **HTTP Handlers** - External API integration points

## Deployment

Deploy to Convex production with:
```bash
npx convex deploy
```

Environment variables and secrets are managed through the Convex dashboard.
